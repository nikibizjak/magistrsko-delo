-- Function map taken directly from the "S. Marlow, S. P. Jones, Making a fast
-- curry" paper.
nil = CON(Nil)

map = FUN(f xs ->
    case xs of
    | Nil -> nil
    | Cons y ys ->
        let h = THUNK(f y)
            t = THUNK(map f ys)
            r = CON(Cons h t)
        in
            r
)